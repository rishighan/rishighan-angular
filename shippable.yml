language: node_js
node_js:
  - 6.7.0
branches:
  only:
      master
build:
  ci:
    - shippable_retry npm i
post_ci:
  - echo "$SHIPPABLE_BUILD_DIR"
  - echo "$SHIPPABLE_REPO_DIR"
  - if [ $IS_PULL_REQUEST == "false" ] ; then BUCKETKEY="$DEPLOYNODECLUSTERBASICAPPFILE_NAME.tar.gz"; fi;
  - if [ $IS_PULL_REQUEST == "false" ] ; then pushd $SHIPPABLE_REPO_DIR && tar cfz /tmp/$BUCKETKEY . && popd; fi;
  - if [ $IS_PULL_REQUEST == "false" ] ; then pushd /tmp && aws s3 cp $BUCKETKEY s3://$BUCKETNAME/ --acl public-read && popd; fi;
  - if [ $IS_PULL_REQUEST == "false" ] ; then echo "versionName=$COMMIT" > $JOB_STATE/deploy-nodecluster-basic-appfile.env; fi;
