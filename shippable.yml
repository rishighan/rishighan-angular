# Language settings
language: node_js
node_js:
  - 6.7.0
branches:
  only:
    master
build:
  ci:
    - echo 'CI is happening...'
    - shippable_retry npm i

  post_ci:
      # DockerHub
      - docker build -t="frishi/rishighanangular_web:$BRANCH.$BUILD_NUMBER" .
      - docker push frishi/rishighanangular_web:$BRANCH.$BUILD_NUMBER
      # Addresses botocore version mismatch errors
      - pip install --upgrade botocore

integrations:
  deploy:
    # AWS Integration to deploy Docker image
    - integrationName: "rg-aws-integration"
      type: aws
      application_name: "rishighan-angular"
      env_name: "rishighan-angular-dev"
      region: "us-east-1"
      image_name: "frishi/rishighanangular_web"
      image_tag: "$BRANCH.$BUILD_NUMBER"

  hub:
    - integrationName: "rg-dockerhub-integration"
      type: docker